# Python基础知识点归纳

注：

1. 本文基于《Python编程：从入门到实践》（_Python Crash Course, 2nd Edition: A Hands-On, Project-Based Introduction to Programming_；以下简称 __PCC2e__）。
2. 本文中阐述的规则原则上适用于版本为`3.6`以上的Python。但如果我 __明确__ 知道文中某个特性不适用于版本低于`3.6`的Python，我也会明确指出（但注意，__仅限__ 我 __明确__ 知道的）。
3. 由于本文作者的“编程母语”为C++，所以文中也会加入一些作者自己对Python和C++（严格来说是C系列语言）的区别的感悟，这些内容不属于PCC2e。这些内容将以 __引用__ 的形式呈现，并使用ℹ️标识。
（但注意，在本文中，ℹ️并不总是表示这种含义，它也存在其他用途。）
5. 由于PCC2e所介绍的Python知识全面性还是有些不足的，全面程度不足，本文作者可能也会自己补充一些认为有必要补充的内容，以扩展读者（以及作者本人）的知识面。

## § 2：变量和简单数据类型

### § 2.1

在Python中，欲在 __控制台窗口__ 上打印内容，可使用如下代码：

```py
print(<content>)
```

其中`<content>`是要打印的内容。

> 示例：
>
> ```py
> print("Hello Python world!")
> ```

> ℹ️ `print()`实质上是一个Python函数，后面你会知道的。

此外，有几个概念需要理解一下：

- __Python解释器__
- __编辑器__
- __语法高亮__

### § 2.2：变量

在Python中，欲 __创建__ 一个 __变量__，可使用如下代码：

```py
<var> = <expr>
```

其中`<var>`是 __变量名__（之前未出现过）；而`<expr>`是一个 __表达式__，它可以是单个的值（如`'abc'`或`12`），也可以是较为复杂的表达式（如`3+5`或`2*(4+8) - num_persons`）。
`<expr>`的值将被赋予`<var>`。

> 示例：
>
> ```py
> message = "Hello Python world!"
> num = 12
> ```

__修改__ 一个变量指的是修改该变量的值。修改变量的语法同上，只是`<var>`是早先出现过的变量名而已。

__使用__ 变量指的是使用该变量的值。如果想要使用一个变量，只要让`<var>`出现在你希望其出现的位置就好了。
如如需打印变量`message`的值，就让`message`出现在`print()`的`()`中即可，像这样：`print(message)`。

> ℹ️ 此外，PCC2e在介绍变量的功能时，采用了一些耐人寻味的表述：
>
>> 每个变量都 __指向__ 一个值——与该变量 __相关联的信息__。
>> 
>> （对赋值的描述：）将变量与值 __关联__ 起来。
>> 
>> （对使用变量的值的描述：）使用 __与变量关联的值__。
>
> 注意，作者采用了上面这样的表述，而不是下面这样的表述：
>
>> 每个变量都 ~~__存储__~~ 一个值，在该变量的 ~~__内部__~~。
>>
>> （对赋值的描述：）向变量内部 ~~__写入__~~ 值。
>>
>> （对使用变量的值的描述：）使用 ~~__变量内部存储的值__~~。
>
> 笔者曾今学过C++，因此对这样的表述是敏感的，知道这些表述很可能反映了这样一个事实：
> 在Python中，所有的变量都是 “__引用类型__”（类似于C/C++中的指针/引用），而根本没有 “__非引用类型__”（如C/C++中的`int`、`double`等常规类型）。
> 看来，说Python中“一切皆对象”，就是像这样。

#### § 2.2.1 变量的命名和使用

在Python中，变量名`<var>`的命名需要遵守一些规则和指南。这些规则共分如下3个级别，违反这些规定的严重性从上到下递减。这些规则和指南如下：

- ❌ 必须遵守的硬性规定。

	- 若不遵守，将会造成Python解释器无法正确解读你所拟定的变量名（事实上它根本不会认为那是个变量名），导致程序崩溃（抛异常）。

- ⚠️ 强烈建议遵守的准则。

	- 若不遵守，虽然程序理论上仍然能正常运行，但是这样的写法是 __强烈不推荐__ 的，您也可能会因此在之后遇到一些难以排查的错误。

- ℹ️ 在Python社区中已经达成共识的通用约定。

	- 若不遵守，您的代码的质量（如可读性）可能会有所下降，他人也可能会误解您的代码。

❌ 硬性规定：

- 变量名只能包含字母、数字和`_`，且不能以数字打头。

	- 这意味着变量名不能包含特殊字符（如使用`Alt`+数字键所打出的那些字符：`!@#$%^&*()`）。
	
	- 同样，__空格__ 也是不允许作为变量名的一部分的。
	
		- 但许多时候变量名取自多个英文单词，在自然的英文中这些词是使用空格隔开的。这时，可以使用`_`来模拟自然语言中的空格。
	
	> ℹ️ 虽然说“变量名只能包含字母、数字和`_`”，但其实许多Unicode字符（如汉字字符）也是可以参与变量名的组成的，如可以将变量命名为`变量`。但这种做法是 __不推荐__ 的。

- 变量名不能是Python关键字（如`def`）。

⚠️ 强烈建议：

- 不要将Python固有的标识符用作变量名（如`print`）。

ℹ️ 通用约定：

- 不要将变量名首字母大写，更不要全部大写（即便在英语中那个词要大写，如`europe_population`中的`europe`）。

	原因：首字母大写的驼峰式变量名在Python中通常表示类名，全部大写的变量名在Python中通常表示常量（虽然Python中其实没有严格意义上的常量）。
	
- 变量名应既简短又有描述性。（如`<noun1>_of_<noun2>`就不如`<noun2>_<noun1>`好。）

- 慎将变量命名为`l`或`O`，因为会分别容易被误以为是`1`和`0`。

#### § 2.2.2 使用变量时避免命名错误

很简单，变量创建之后，不要把它拼错就好了（如创建了`message`之后，后文中不要将其拼成`mesage`；否则会抛`NameError`异常）。

#### § 2.2.3 变量是标签

略，前文（）中已经覆盖了。

### § 2.3：字符串

Python中有多种数据类型，如 __字符串__（string，Python代码中表示为`str`）、__整型__（integer，Python代码中表示为`int`）和 __浮点型__（float，Python代码中表示为`float`）。
这里先介绍 __字符串__ 这种数据类型。

在Python中字符串使用一对`'`或`"`扩起，例如：

```py
"This is a string."
'This is also a string.'
```

字符串中可以包含任意字符，但有如下值得注意的地方：

- 用`"`扩起的字符串可以正常包含`'`；但如果要包含`"`字符，请使用`\"`。
- 用`'`扩起的字符串可以正常包含`"`；但如果要包含`'`字符，请使用`\'`。

因此，如果字符串要包含`'`，可以用`"`表示该字符串；如果要包含`"`，则用`'`表示。如：

```py
'I told my friend, "Python is my favorite language!"'
"The language 'Python' is Guido van Rossum's creation."
```

但这还没完。针对以上两种形式的字符串，都有如下需要注意的地方：

- 不管是哪种字符串，要包含`\`字符，请使用`\\`。
- 不管是哪种字符串，如果要表示换行，请使用`\n`。
- 想包含一个 __制表符__（tab），可以直接按`Tab`键输入，但更常见的方式是使用`\t`。

> ℹ️ 因为一些字符具有特定的功能（如`"`和`'`（在特定情况下）标示字符串的结束，
> 换行符（按Enter之后输入的能产生换行效果的字符（不过Windows中可能是`\r\n`而非简单的`\n`），在Python代码中也有一定的特殊意义），
> 所以要正常地显示这些字符，可能需要进行 __转义__，即使用`\` + 一个英文字母的形式来显示它们（如`\"`、`\'`、`\n`等）。
> 
> 包括`\`字符——因为会被用于转义，想要让其正常显示，也需要转义，即使用`\\`来表示。要想显示2个`\`，请使用2个`\\`来表示。

#### § 2.3.1 使用方法修改字符串的大小写

对于字符串，可以使用下面的语法来生成一个新的字符串，这个字符串由原来的字符串大小写按照特定规律变更后（当然也有较小的概率恰好不变）得到。
假定`<str>`是任何运算结果为字符串的表达式（可以是一个简单的字符串（如`'abc'`）或值为字符串的变量，也可以是复杂表达式），那么，可在它之后加一个`.`，然后接如下代码之一，以进行如下操作：

- `title()`：将 该字符串 按 其中的每个单词（字段）首字母大写、之后的字母小写的形式 显示之后 得到的新字符串，就像标题（title）那样；
- `upper()`：将 该字符串的所有字母大写之后 得到的新字符串；
- `lower()`：将 该字符串的所有字母小写之后 得到的新字符串。

> ℹ️ 这里跟在`<str>`后面的「`.` + 名称 + `()`」结构，其实是对 __对象__（object）的 __方法__（method）调用。方法是特殊的函数。
> 现在你只要知道形如`.title()`的语法表示的是“方法调用”，而`title()`是“方法”（或“函数”），就好了。至于更具体的内容，到 § 9 我们再详细讨论。

如：

```py
>>> name = 'Ada lovelace'
>>> name.title()
'Ada Lovelace'
>>> name.upper()
'ADA LOVELACE'
>>> name.lower()
'ada lovelace'
```

> ⚠️ 1. 注意，以上三个方法只是产生基于原先的字符串的新字符串，但不改变原先的字符串的值。因此，在上例中，调用完以上方法后，`name`的值依然是`Ada lovelace`，而不是其他的。
> 
> ℹ️ 2. 值得注意的是，阐述3个方法时所说的“字母”一词，不仅指代普通的英文字母（ASCII字符），还包括带有diacritic的拉丁字母，甚至希腊字母和西里尔字母（俄语使用的字母）。如：
> 
> ```py
> >>> name = 'álvaro'
> >>> name.title()
> 'Álvaro'
> >>> s = 'αβγ'
> >>> s.upper()
> 'ΑΒΓ'
> >>> nation = 'русский'
> >>> nation.upper()
> 'РУССКИЙ'
> ```
> 
> ℹ️ 3. 方法`title()`不仅将字符串中的每个单词首字母大写，还将其之后的字母小写。如：
> 
> ```py
> >>> name = 'aDa lOvElAce'
> >>> name.title()
> 'Ada Lovelace'
> ```
> 
> 得到的结果是`'Ada Lovelace'`，而非`'ADa LOvElAce'`。
> 
> ℹ️ 4. 方法`title()`常用以显示标准格式的人名，但对于一些特殊的、并非只有首字母要大写的人名（如含有“Mc-”成分的名字），光使用它将无法达到目标。如：
> 
> ```py
> >>> name = 'joseph mccarthy'
> >>> name.title()
> >>> 'Joseph Mccarthy'
> ```
> 我们期待的格式是`'Joseph McCarthy'`，但这里显示的却是`Joseph Mccarthy`。因此要处理这样的人名，仅仅使用方法`title()`是不足的。

#### § 2.3.2 在字符串中使用变量

有时，我们可能会希望在字符串中插入一些特定表达式的值，如，我们可能会想这样一句话（字符串形式）：

> 2 and 3 is (2+3).

这里我们希望将「2+3」的运算结果，即「5」，填入该字符串——但不希望直接将「5」直接填入。这在Python中怎么实现呢？

答案是，可以使用 __f字符串__ 来实现这一功能，即使用`f" "`或`f' '`（或`F" "` / `F' '`）将信息扩起，并将其中的表达式（能够返回值Python代码）用`{ }`扩起。
这样，上面这句话，我们就可将其用`f"The sum of 2 and 3 is (2+3)."`表示。

```py
>>> message = f"The sum of 2 and 3 is {2+3}."
```

查看一下`message`的值，结果发现：

```py
>>> message
'The sum of 2 and 3 is 5.'
```

当然，这还是比较简单的例子。\[TODO]

#### § 2.3.3 使用制表符或换行符来添加空白

前面已经说过了，欲在字符串中包含换行符，请使用`\n`；欲包含制表符，可以直接在字符串中按Tab，但更常见的方法是使用`\t`。

这些字符被称为 __空白__。在编程中，空白泛指任何 __非打印字符__。空白可以用来 __组织输出__，让用户阅读起来更容易。

举例：

```py
>>> print("\tPython")
	Python
>>> print("Line 1\nLine 2\nLine 3")
Line 1
Line 2
Line 3
```

`\n`、`\t`以及其他的各种转义字符可以同时出现在一个字符串中。通过多次使用`\n`，可以用一个单行生成多行输出，像上面这样。

#### § 2.3.4 删除空白

有时，字符串中会有额外的空白，但可能它们对于你来说是多余的，应当被忽略。
在这种情况下，可以使用方法`lstrip()`、`rstrip()`或`strip()`来获得一个删除了原先字符串中多余的空白的新字符串（但不改变原先的字符串的值，就像方法`title()`、`upper()`、`lower()`那样）。
这些方法的功能如下：

- `lstrip()`：得到 一个 删除了 字符串最左侧（即开头处）的空白 的 新字符串。
- `rstrip()`：得到 一个 删除了 字符串最右侧（即结尾处）的空白 的 新字符串。
- `strip()`：得到 一个 删除了 字符串两侧的空白 的 新字符串。

示例：

```py
>>> lang = '   python   '
>>> lang.lstrip()
'python   '
>>> lang.rstrip()
'   python'
>>> lang.strip()
'python'
```

> ℹ️ 到目前为止，我们学过的6个字符串方法都是返回一个基于原先字符串的新字符串，而不更改原先的字符串。
> 如果希望这些方法能够更改原先的字符串，要将方法调用得到的结果关联到原先的变量，语法为`<str_var> = <str_var>.<str_method_name>()`。
> 其中`<str_var>`为类型为字符串的变量，`<str_method_name>`为我们学过的6个针对字符串的方法（以及其他针对字符串且不更改原先字符串的方法
> ——当然如果更改且也返回值，这样写也是可以的，但就实在没必要了）。

#### § 2.3.5 使用字符串时避免语法错误

很简单，就注意这一点就行了：字符串中若要出现未转义的`'`或`"`，请务必保持谨慎，一定要注意你的字符串是用哪种引号扩起的。
（当然，应该在编写该字符串的代码之前就意识到是否需要使用`'`或`"`。）
否则，会引发 __语法错误__（`SyntaxError`异常）。

语法高亮有助于你发现这样的错误。

### § 2.4 数

Python中的数有 __整数__ 和 __浮点数__ 两种类型的数。

##### 数的类型：整数和浮点数

###### 整数

__整数__（integer，对应的Python类型为`int`）指一切没有小数点的数。
它们在Python中的表示方法与在数学中的表示相同，如`1`、`0`、`2021`、`-273`。

> ⚠️ 与C系列语言不同，Python中的整数没有分成长度不同的各种整型（如C/C++和Java中的`int`、`short`、`long`那样），而且没有明确的大小限制，想多大就可以多大。

###### 浮点数

__浮点数__（float，对应的Python类型为`float`）指一切有小数点的数。
在Python中，它们可以像数学上那样用`.`表示，如`3.14`、`0.618`、`-273.15`。

⚠️ 但注意，像`2.0`这样的实际上是（数学意义上的）整数的数，Python也将它们视为浮点数（即类型为`float`）。__不要小看这一点__，这会对一些事情产生影响，如除法运算。

> ℹ️ 若要使用数学上的分数表示法，可以使用除法运算符`/`来表示（见下）。
> ℹ️ 除了常见的`.`表示法，就像其他许多编程语言那样，Python也支持`E`表示法（取自英语exponent（指数）一词；模拟数学上的 __科学计数法__），即`<a>e<ex>`或`<a>E<ex>`这样形式的数——它表示`<a>`乘以10的`<ex>`次方。
> 如`6.0e24`或`6.67E-11`。`E`表示法非常适合用来表示绝对值很大或很小的数。
> 	⚠️ 就像`2.0`那样，所有用`E`表示法表示的数都会被Python视为浮点数（类型为`float`），即便实际上是（数学意义上的）整数。如`2e5`、`6.0e24`。
> 	ℹ️ 事实上，`<a>`并不一定非要像严格的科学计数法那样，处于区间\[1, 10)中，如`12e4`和`0.8e9`。但`<ex>`必须是整数（也就是说像`2e5.3`这样的表达是不允许的）。
 
##### 运算

在Python中，两个数之间可以进行如下运算（此时两个数被称为 __操作数__（operand），我们分别将其称为「数1」「数2」）：

| 运算名 | 运算符名（英文） | 运算名（英文） | 运算符 | 解释 |
| ------ | --------------- | ------------- | ----- | ---- |
| 加法 | plus | addition | `+` | |
| 减法 | minus | subtraction | `-` | |
| 乘法 | multiplied by | multiplication | `*` | |
| 除法 | divided by | division | `/` | |
| 整除 | | | `//` | 返回两数相除后的整数部分
| 模？ | | | `%` | 返回两数相除后的余数 |
| 乘方 | / | power | `**` | 以数1为底数，数2为指数的幂的值 |

演示（仅限整数）：

```
>>> 3 + 5
8
>>> 12 - 5
7
>>> 5 * 6
30
>>> 25 / 4
6.25
>>> 25 // 4
6
>>> 25 % 4
1
>>> 6 ** 3
216
```

> ⚠️ 注意，`/`、`//`、`%`运算要求「数2」（除数）不能等于`0`，否则会引发错误（`ZeroDivisionError`异常）。
> 
> ℹ️ 与C/C++不同的是，Python对两个整数进行的`/`运算的结果即为实际的商，而C/C++中这样的`/`运算结果则只是商的整数部分。
> ℹ️ 对于`//`和`%`运算，Python还允许操作数是浮点数（如`13.5 // 4`和`25.8 % 3.2`这样的写法是允许的），而C/C++的`%`运算要求两个操作数都是整型。

###### 操作数运算结果的类型与操作数自身类型之间的关系

对于以上所讲的任意运算，操作数运算结果类型与操作数自身类型之间的关系，见下表：

| 运算 | 操作数中有浮点数时，运算结果数据类型 | 操作数均为整数时，运算结果数据类型 |
| - | - | - |
| `+`, `-`, `*`, `%`, `**` | 浮 | 整 |
| `/` | 浮 | 浮 |
| `//` | 整 | 整 |

> ℹ️ 想知道一个表达式的数据类型，可以使用Python代码`type(<expr>)`来查询，其中`<expr>`是要查询类型的表达式。
> 查询结果以`<class '<type>'>`的形式展现，其中`<type>`为`<expr>`（的结果）的数据类型。
> 
> 演示：
> 
> ```py
> >>> type(0)
> <class 'int'>
> >>> type(1.0)
> <class 'float'>
> >>> type(4 / 2)
> <class 'float'>
> >>> type(13.0 // 4)
> <class 'float'>
> >>> type("Hello Python world!")
> <class 'str'>
> >>> type(int)
> <class 'type'>

##### 下划线表示法

有时，我们会需要表示一些很大的数，而用普通的写法去书写这些数不方便阅读与理解。如：

```python
c_int_max = 2147483647
c_uint_max = 4294967295
```

这时，可以使用`_`模拟三位分隔符，对数字进行分割：

```python
c_int_max = 2_147_483_647
c_uint_max = 4_294_967_295
```

但其实，`_`不一定非要每3位出现一次。也可以这样：

```python
c_int_max = 21_4748_3647
```

甚至可以更随意些，像下面这样：

```python
c_int_max = 214_748_3647
c_uint_max = 4_29_4967_29_5
```

Python解释器会忽略数字中的`_`——在Python看来，`10000`、`10_000`和`1_0000`没有区别。因此，如果在Python命令行中询问`c_int_max`和`c_uint_max`，情况会像下面这样：

```py
>>> c_int_max = 2_147_483_647
>>> c_int_max
2147483647
>>> c_uint_max = 429_496_7295
>>> c_uint_max
4294967295
```

这种表示法不仅适用于整数，也适用于浮点数，且可以在小数部分出现：

```py
>>> pi = 3.14159_26535_89793
>>> pi
3.141592653589793
```

⚠️ `_`表示法要求Python版本要 ≥ `3.6`。

##### 小数的“怪异行为”

有时，Python的小数会出现一些“怪异行为”，如：

```py
>>> 0.2 + 0.1
0.30000000000000004
>>> 3 * 0.1
0.30000000000000004
```

可以看到，在数学上，两个表达式的结果都应当是`0.3`。但Python的计算结果显示，它们被计算为 很接近，但不等于`0.3`的数。

为什么会这样？这涉及到了浮点数在计算机中的表示法，而每个语言都会有这样的问题。这里我就不做阐述了，有兴趣可以阅读这篇文章：<https://0.30000000000000004.com/>。（网站名还真有趣，哈哈）

##### 同时给多个变量赋值

可在一行中同时给多个变量赋值（含创建变量），例如：

```py
x, y, z = 0, 1, 2
```

使用这种语法，关键是要保证左侧的变量数目和右侧的表达式数目相同，否则会出错（`ValueError`异常）。

##### 常量

__常量__（constant）指在程序的整个生命周期的中值都保持不变的量。
像`0`、`-273`、`"Hello"`这样的一眼可以看到值的量（值写在字面上的量），称为 __字面值常量__（literal constant）。我们这里讨论具有变量形式的常量，即用变量名所表示的常量。

与C系语言不同，Python没有办法保证一个数一定是常量。想要让一个量保持不变，全靠程序员自觉，而这个量本质上依然是变量。
在Python中，程序员通常用全部字母大写的变量名，来表示应当将某个变量 __视为__ 常量。如：

```py
MAX_CONNECTIONS = 5000
```

### § 2.5：注释

__注释__（comment）本质上指的是 在代码中添加的会被解释器（或编译器）忽略的内容。设置这种东西的初衷在于允许程序员用自然语言在代码中添加说明，
通常是为了方便代码阅读者（包括作者自己）理解代码中的一些不太容易理解的内容。

在Python中，__注释__ 用`#`标识。一条注释从`#`处开始，到行尾结束。如：

```py
# Say hello to everybody.
print("Hello, Python users!") # use print() to print a message onto the console
```

### § 2.6：Python之禅

略。在Python命令行输入`import this`即可阅读。
